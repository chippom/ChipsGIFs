document.addEventListener('DOMContentLoaded',function(){if('caches' in window){caches.open('my-gif-cache').then(function(cache){document.querySelectorAll('.gif-item img').forEach(function(img){cache.add(img.src)})})}var darkModeToggle=document.getElementById('toggleDarkMode');var body=document.body;if(darkModeToggle){darkModeToggle.addEventListener('click',function(){body.classList.toggle('dark-mode');localStorage.setItem('darkMode',body.classList.contains('dark-mode'))})}if(localStorage.getItem('darkMode')==='true'){body.classList.add('dark-mode')}var gifContainer=document.querySelector('.gif-container');gifContainer.addEventListener('click',function(e){if(e.target.classList.contains('download-btn'))return;var gifItem=e.target.closest('.gif-item');if(gifItem){var img=gifItem.querySelector('img');var existingOverlay=document.querySelector('.fullsize-overlay');if(existingOverlay){document.body.removeChild(existingOverlay)}var overlay=document.createElement('div');overlay.className='fullsize-overlay';var fullsizeImage=document.createElement('img');fullsizeImage.src=img.src;fullsizeImage.className='fullsize-image';overlay.appendChild(fullsizeImage);document.body.appendChild(overlay);overlay.addEventListener('click',function(){document.body.removeChild(overlay)})}});var starContainer=document.createElement('div');starContainer.style.position='fixed';starContainer.style.pointerEvents='none';starContainer.style.zIndex='9999';document.body.appendChild(starContainer);var stars=[];var starCount=5;for(var i=0;i<starCount;i++){var star=document.createElement('div');star.textContent='â˜…';star.className='star';starContainer.appendChild(star);stars.push(star)}var currentIndex=0;function updateStarPosition(e){if(!e||!e.clientX||!e.clientY)return;var star=stars[currentIndex];star.style.left=e.clientX+'px';star.style.top=e.clientY+'px';star.style.opacity='1';setTimeout(function(){star.style.opacity='0'},500);currentIndex=(currentIndex+1)%starCount}document.addEventListener('mousemove',updateStarPosition);document.querySelectorAll('.download-btn').forEach(function(button){var gifName=button.getAttribute('data-gif');var countSpan=button.nextElementSibling;var storedCount=localStorage.getItem("downloads_"+gifName)||0;if(countSpan){countSpan.textContent="Downloads: "+storedCount}button.addEventListener('click',function(){var gifName=this.getAttribute('data-gif');var link=document.createElement('a');link.href=gifName;link.download=gifName;document.body.appendChild(link);link.click();document.body.removeChild(link);var countSpan=this.nextElementSibling;if(countSpan){var count=parseInt(localStorage.getItem("downloads_"+gifName)||0);count++;localStorage.setItem("downloads_"+gifName,count);countSpan.textContent="Downloads: "+count}})});document.querySelectorAll('.gif-item img').forEach(function(img){var originalSrc=img.src;img.src='placeholder.jpg';img.dataset.src=originalSrc});var observer=new IntersectionObserver(function(entries,observer){entries.forEach(function(entry){if(entry.isIntersecting){var img=entry.target;img.src=img.dataset.src;observer.unobserve(img)}})},{rootMargin:'200px'});document.querySelectorAll('.gif-item img').forEach(function(img){observer.observe(img)});function loadConsentBanner(){fetch('consent-banner.html').then(function(response){return response.text()}).then(function(html){var consentContainer=document.createElement('div');consentContainer.innerHTML=html;document.body.appendChild(consentContainer);var acceptButton=consentContainer.querySelector('button');acceptButton.addEventListener('click',function(){document.getElementById('consent-banner').style.display='none';localStorage.setItem('cookiesAccepted','true');document.querySelectorAll('.download-btn').forEach(function(button){button.disabled=false})})})}if(localStorage.getItem('cookiesAccepted')==='true'){document.querySelectorAll('.download-btn').forEach(function(button){button.disabled=false})}else{document.querySelectorAll('.download-btn').forEach(function(button){button.disabled=true});loadConsentBanner()}});
